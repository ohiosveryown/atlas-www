<template>
  <div class="app">
    <img
      class="mesh mesh-01"
      src="https://res.cloudinary.com/da32ufmnf/image/upload/v1645844457/atlas/lp0neont7qe3uhdnorna.png"
      alt="mesh gradient"
    />
    <navigation />
    <main class="width">
      <intro />
      <section>
        <section-header
          class="scroll-target green hide--sm"
          heading="Onboarding made"
          highlight="easy"
          icon="https://res.cloudinary.com/da32ufmnf/image/upload/v1645721930/atlas/yuragpqjv0ldyzwxnput.png"
          bg="https://res.cloudinary.com/da32ufmnf/image/upload/v1645725400/atlas/akiielqlt2mojbtt7zfy.png"
          subheading="Seamlessly import your existing customer data with our contact migration
        tool and be up and running in no time."
        />
        <card-wide
          class="scroll-target"
          heading="Jumpstart your productivity"
          subheading="Use our import tool to move tickets and customer data in bulk from
          legacy systems into Atlas â€“ in no time."
          icon01="https://res.cloudinary.com/da32ufmnf/image/upload/v1645730789/atlas/ek9smi1lxr2tluyz7uvx.png"
          icon02="https://res.cloudinary.com/da32ufmnf/image/upload/v1645730789/atlas/ek9smi1lxr2tluyz7uvx.png"
          icon03="https://res.cloudinary.com/da32ufmnf/image/upload/v1645730789/atlas/ek9smi1lxr2tluyz7uvx.png"
          mesh="https://res.cloudinary.com/da32ufmnf/image/upload/v1645727807/atlas/e9hdo4knpnhca8kddcyg.png"
          liOne="Import customer data"
          liTwo="Integrations"
          liThree="Chat"
          product="https://res.cloudinary.com/da32ufmnf/image/upload/v1645729570/atlas/oed09rxp6ev0etchgp1q.png"
        />
      </section>

      <section class="scroll-target cards">
        <card
          class="card--sm card--padding"
          icon="https://res.cloudinary.com/da32ufmnf/image/upload/v1645730789/atlas/ek9smi1lxr2tluyz7uvx.png"
          heading="Respond faster"
          subheading="Supercharge your daily routine with batch actions, shortcuts, and automations."
          product="https://res.cloudinary.com/da32ufmnf/image/upload/v1645745514/atlas/ofkx9jbjnsajs79r8bcl.png"
          bg="https://res.cloudinary.com/da32ufmnf/image/upload/v1645743334/atlas/ncpqxsglovghqmj37iyg.png"
        />

        <card
          class="card--md"
          icon="https://res.cloudinary.com/da32ufmnf/image/upload/v1645730789/atlas/ek9smi1lxr2tluyz7uvx.png"
          heading="Smarter insights"
          subheading="Convert your customer conversations into data driven insights to drive your product and engineering roadmaps."
          product="https://res.cloudinary.com/da32ufmnf/image/upload/v1645742402/atlas/gr8lf3spcuhj7mbe0j5l.png"
          bg="https://res.cloudinary.com/da32ufmnf/image/upload/v1645742612/atlas/hgaeayz5pmhbkkkncyv6.png"
        />
      </section>

      <section>
        <section-header
          class="scroll-target blue"
          heading="Conversation in"
          highlight="one place"
          icon="https://res.cloudinary.com/da32ufmnf/image/upload/v1645801797/atlas/j5nt1ouuhuwdmqnul8wl.png"
          bg="https://res.cloudinary.com/da32ufmnf/image/upload/v1645802678/atlas/hhrvmz0jusz4tvxrz5yq.png"
          subheading="Chat, ticketing, and automated communications all in one place.
          See the whole conversation with your customers."
        />

        <card-wide
          class="scroll-target"
          heading="Tools to foster customer relationships"
          subheading="Chat, ticketing, and automated communications all in one place.
          See the whole conversation with your customers."
          icon01="https://res.cloudinary.com/da32ufmnf/image/upload/v1645730789/atlas/ek9smi1lxr2tluyz7uvx.png"
          icon02="https://res.cloudinary.com/da32ufmnf/image/upload/v1645730789/atlas/ek9smi1lxr2tluyz7uvx.png"
          icon03="https://res.cloudinary.com/da32ufmnf/image/upload/v1645730789/atlas/ek9smi1lxr2tluyz7uvx.png"
          mesh="https://res.cloudinary.com/da32ufmnf/image/upload/v1645801956/atlas/eq5ojyyszgjghiev7c1y.png"
          liOne="All-in-one composer"
          liTwo="Chat with Slack integration"
          liThree="Multi-channel responses (Coming Soon)"
          product="https://res.cloudinary.com/da32ufmnf/image/upload/v1645801957/atlas/bfqlxpaokdjxhe9osr0h.png"
        />
        <div class="scroll-target horizontal-scroll">
          <card
            class="card--md"
            icon="https://res.cloudinary.com/da32ufmnf/image/upload/v1645730789/atlas/ek9smi1lxr2tluyz7uvx.png"
            heading="Customer Timeline"
            subheading="Supercharge your daily routine with batch actions, shortcuts, and automations."
            product="https://res.cloudinary.com/da32ufmnf/image/upload/v1645854514/atlas/sztd3fc3v0kw3e1tymrk.png"
            bg="https://res.cloudinary.com/da32ufmnf/image/upload/v1645805170/atlas/nnlfwnrw6g1mlqtu7uhd.png"
          />

          <card
            class="card--md"
            icon="https://res.cloudinary.com/da32ufmnf/image/upload/v1645730789/atlas/ek9smi1lxr2tluyz7uvx.png"
            heading="Ticket History"
            subheading="Convert customer conversations into data driven insights to drive your product roadmap."
            product="https://res.cloudinary.com/da32ufmnf/image/upload/v1645854514/atlas/sgeakeifve1kpzr2jr5t.png"
            bg="https://res.cloudinary.com/da32ufmnf/image/upload/v1645805170/atlas/f8kyzjyzmdpcftqd0bmc.png"
          />

          <card
            class="card--md"
            icon="https://res.cloudinary.com/da32ufmnf/image/upload/v1645730789/atlas/ek9smi1lxr2tluyz7uvx.png"
            heading="API"
            subheading="Convert your customer conversations into data driven insights to drive your product and engineering roadmaps."
            product="https://res.cloudinary.com/da32ufmnf/image/upload/v1645854514/atlas/jigxvku2pqtaoat5w5b3.png"
            bg="https://res.cloudinary.com/da32ufmnf/image/upload/v1645805258/atlas/izmgylyhimf7hxszd6uu.png"
          />

          <card
            class="card--md"
            icon="https://res.cloudinary.com/da32ufmnf/image/upload/v1645730789/atlas/ek9smi1lxr2tluyz7uvx.png"
            heading="Smarter insights"
            subheading="Convert your customer conversations into data driven insights to drive your product and engineering roadmaps."
            product="https://res.cloudinary.com/da32ufmnf/image/upload/v1645854514/atlas/sztd3fc3v0kw3e1tymrk.png"
            bg="https://res.cloudinary.com/da32ufmnf/image/upload/v1645742612/atlas/hgaeayz5pmhbkkkncyv6.png"
          />
        </div>
        <div class="progress-container">
          <div class="progress-bar" id="myBar"></div>
        </div>
      </section>

      <section class="scroll-target">
        <card-full />
      </section>

      <p class="mt-9">
        Lorem ipsum dolor, sit amet consectetur adipisicing elit. Non iure amet
        illum quasi voluptas nam minus atque! Minus nemo quia quasi tenetur
        nesciunt cumque, voluptas earum architecto, aliquid harum molestiae.
      </p>
    </main>
  </div>
</template>

<style lang="scss" scoped>
  @import "~static/style/grid.scss";

  .scroll-target {
    opacity: 0;
    transform: translateY(4rem);
    transition: all 600ms ease 600ms;
    will-change: transform, opacity;
  }

  .active {
    opacity: 1;
    transform: translateY(0);
  }

  .mesh {
    pointer-events: none;
  }

  .mesh-01 {
    position: absolute;
    top: 0;
    right: 0;
    @include breakpoint(md) {
      opacity: 0.88;
    }
  }

  .cards {
    margin-bottom: 19.6rem;
    @include breakpoint(md) {
      display: flex;
      justify-content: space-between;
      margin-bottom: 19.6rem;
    }
  }

  .card--sm {
    @include breakpoint(md) {
      width: grid-width(5);
    }
  }

  .card--md {
    @include breakpoint(md) {
      width: grid-width(6.5);
    }
  }

  .progress-container {
    position: relative;
    margin: 2rem auto 10rem;
    width: 100%;
    height: 5px;
    border-radius: 50px;
    background: rgba(255, 255, 255, 0.2);
    overflow: hidden;
    @include breakpoint(md) {
      margin-bottom: 20rem;
    }
  }

  .progress-bar {
    height: 5px;
    background: linear-gradient(106.92deg, #2942ee 0%, #a056ff 98.96%);
    border-radius: 50px;
    width: 0%;
  }

  .horizontal-scroll {
    display: flex;
    overflow-x: auto;
    -ms-overflow-style: none;
    scrollbar-width: none;
    cursor: grab;
    transition: transform 300ms ease;
    will-change: transform;
    * {
      margin-right: 2rem;
      flex: 0 0 grid-width(10);
      @include breakpoint(md) {
        margin-right: 4.8rem;
        flex: 0 0 grid-width(5);
      }
    }
  }

  .horizontal-scroll::-webkit-scrollbar {
    display: none;
  }
</style>

<script>
  export default {
    mounted() {
      const elements = document.querySelectorAll(".scroll-target")

      let observer = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          if (entry.intersectionRatio > 0) {
            entry.target.classList.add("active")
          }
        })
      })

      elements.forEach((e) => {
        observer.observe(e)
      })

      const progressBar = document.querySelector(".progress-bar")
      const section = document.querySelector(".horizontal-scroll")
      let currentPixel = section.scrollLeft
      let isDown = false
      let startX
      let scrollLeft

      section.addEventListener("scroll", () => {
        const winScroll = section.scrollLeft || section.scrollLeft
        const width = section.scrollWidth - section.clientWidth
        const scrolled = (winScroll / width) * 100
        progressBar.style.width = scrolled + "%"

        this.scrollpos = section.scrollLeft
      })

      section.addEventListener("mousedown", (e) => {
        isDown = true
        slider.classList.add("active")
        startX = e.pageX - slider.offsetLeft
        scrollLeft = slider.scrollLeft
      })

      section.addEventListener("mousedown", (e) => {
        section.style.cursor = "grabbing"
        section.style.transform = "scale(.98)"
        isDown = true
        startX = e.pageX - section.offsetLeft
        scrollLeft = section.scrollLeft
      })

      section.addEventListener("mouseup", () => {
        section.style.transform = "scale(1)"
        section.style.cursor = "grab"
        isDown = false
      })

      section.addEventListener("mousemove", (e) => {
        if (!isDown) return
        e.preventDefault()
        const x = e.pageX - section.offsetLeft
        const walk = (x - startX) * 0.8
        section.scrollLeft = scrollLeft - walk
      })
    },
  }
</script>
