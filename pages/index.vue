<template>
  <div class="app">
    <img
      class="mesh mesh-01"
      src="https://res.cloudinary.com/da32ufmnf/image/upload/v1645844457/atlas/lp0neont7qe3uhdnorna.png"
      alt="mesh gradient"
    />
    <navigation />
    <div class="x">
      <main class="width">
        <intro
          heading="Give your customers superhuman support"
          subheading="Atlas is a blazingly fast, modern support platform, helping identify and diagnose customer experience and interaction."
        />
        <section>
          <section-header
            class="scroll-target green hide--sm"
            heading="Setup in a"
            highlight="flash"
            icon="https://res.cloudinary.com/da32ufmnf/image/upload/v1645721930/atlas/yuragpqjv0ldyzwxnput.png"
            bg="https://res.cloudinary.com/da32ufmnf/image/upload/v1645725400/atlas/akiielqlt2mojbtt7zfy.png"
            subheading="Seamlessly import your existing customer data with our contact migration
          tool and be up and running in no time."
          />
          <card-wide
            class="scroll-target"
            heading="Jumpstart your productivity"
            subheading="Use our import tool to move tickets and customer data in bulk from
            legacy systems into Atlas – in no time."
            icon01="https://res.cloudinary.com/da32ufmnf/image/upload/v1645730789/atlas/ek9smi1lxr2tluyz7uvx.png"
            icon02="https://res.cloudinary.com/da32ufmnf/image/upload/v1646017822/atlas/dtrez6rzvr8q6uipr0nh.png"
            icon03="https://res.cloudinary.com/da32ufmnf/image/upload/v1646017885/atlas/wwwaxqcle1kwdfunejd8.png"
            mesh="https://res.cloudinary.com/da32ufmnf/image/upload/v1645727807/atlas/e9hdo4knpnhca8kddcyg.png"
            liOne="Import customer data"
            liTwo="Integration support"
            liThree="Single snippet install"
            product="https://res.cloudinary.com/da32ufmnf/image/upload/v1645729570/atlas/oed09rxp6ev0etchgp1q.png"
          />
        </section>

        <section class="scroll-target cards">
          <card
            class="card--sm card--padding"
            icon="https://res.cloudinary.com/da32ufmnf/image/upload/v1646017945/atlas/ionehpf0mrpe44w4tibi.png"
            heading="Respond faster"
            subheading="Supercharge your daily routine with batch actions, shortcuts, and automations."
            product="https://res.cloudinary.com/da32ufmnf/image/upload/v1645745514/atlas/ofkx9jbjnsajs79r8bcl.png"
            bg="https://res.cloudinary.com/da32ufmnf/image/upload/v1645743334/atlas/ncpqxsglovghqmj37iyg.png"
          />

          <card
            class="card--md"
            icon="https://res.cloudinary.com/da32ufmnf/image/upload/v1646018009/atlas/a5rgrlkulb78dhp8sonb.png"
            heading="Smarter insights"
            subheading="Convert your customer conversations into data driven insights to drive your product and engineering roadmaps – coming soon."
            product="https://res.cloudinary.com/da32ufmnf/image/upload/v1646060579/atlas/rrsjyll6bxv41pxnlm7j.png"
            bg="https://res.cloudinary.com/da32ufmnf/image/upload/v1645742612/atlas/hgaeayz5pmhbkkkncyv6.png"
          />
        </section>

        <section>
          <section-header
            class="scroll-target blue"
            heading="Customer context in"
            highlight="one place"
            icon="https://res.cloudinary.com/da32ufmnf/image/upload/v1645801797/atlas/j5nt1ouuhuwdmqnul8wl.png"
            bg="https://res.cloudinary.com/da32ufmnf/image/upload/v1645802678/atlas/hhrvmz0jusz4tvxrz5yq.png"
            subheading="Chat, ticketing, and automated communications all in one place.
            See the whole conversation with your customers."
          />

          <card-wide
            class="scroll-target"
            heading="Tools to foster customer relationships"
            subheading="See your customers' journey from all sides: session recordings, console and server errors, and your internal tools in a single location right when you need them."
            icon01="https://res.cloudinary.com/da32ufmnf/image/upload/v1646018251/atlas/kukcyhzfydoj4rpnh9ed.png"
            icon02="https://res.cloudinary.com/da32ufmnf/image/upload/v1646018251/atlas/jt0c7sghhq9ic4skf04h.png"
            icon03="https://res.cloudinary.com/da32ufmnf/image/upload/v1646018251/atlas/hm6fdm0mt1aejv8lpui4.png"
            mesh="https://res.cloudinary.com/da32ufmnf/image/upload/v1645801956/atlas/eq5ojyyszgjghiev7c1y.png"
            liOne="Session recordings"
            liTwo="Bug tracking"
            liThree="Internal tool integration"
            product="https://res.cloudinary.com/da32ufmnf/image/upload/v1646077730/atlas/zyz3cisg5jldj5v06bim.png"
          />
          <div class="scroll-target horizontal-scroll">
            <card
              class="card--md"
              icon="https://res.cloudinary.com/da32ufmnf/image/upload/v1645730789/atlas/ek9smi1lxr2tluyz7uvx.png"
              heading="Customer Timeline"
              subheading="Understand your customers' journey with conversations and events in a single timeline."
              product="https://res.cloudinary.com/da32ufmnf/image/upload/v1645854514/atlas/sztd3fc3v0kw3e1tymrk.png"
              bg="https://res.cloudinary.com/da32ufmnf/image/upload/v1645805170/atlas/nnlfwnrw6g1mlqtu7uhd.png"
            />

            <card
              class="card--md"
              icon="https://res.cloudinary.com/da32ufmnf/image/upload/v1646018716/atlas/dvvvpdbzg9brokh2r1pi.png"
              heading="Ticket History"
              subheading="Know your customers most pressing and time sensitive issues."
              product="https://res.cloudinary.com/da32ufmnf/image/upload/v1645854514/atlas/sgeakeifve1kpzr2jr5t.png"
              bg="https://res.cloudinary.com/da32ufmnf/image/upload/v1645805170/atlas/f8kyzjyzmdpcftqd0bmc.png"
            />

            <card
              class="card--md"
              icon="https://res.cloudinary.com/da32ufmnf/image/upload/v1646017885/atlas/wwwaxqcle1kwdfunejd8.png"
              heading="API"
              subheading="Access your customer data with granular endpoints to create a customized experience."
              product="https://res.cloudinary.com/da32ufmnf/image/upload/v1646061545/atlas/ovgms0veq9vdkrpwqij5.png"
              bg="https://res.cloudinary.com/da32ufmnf/image/upload/v1645805258/atlas/izmgylyhimf7hxszd6uu.png"
            />

            <card
              class="card--md"
              icon="https://res.cloudinary.com/da32ufmnf/image/upload/v1646062351/atlas/ymxgv5n3o4wmtvypsun6.png"
              heading="Command Menu"
              subheading="Use the command menu for efficiency with comprehensive keyboard shortcuts."
              product="https://res.cloudinary.com/da32ufmnf/image/upload/v1646061773/atlas/jwbhukdv9iqh7ecj2bq7.png"
              bg="https://res.cloudinary.com/da32ufmnf/image/upload/v1645742612/atlas/hgaeayz5pmhbkkkncyv6.png"
            />
          </div>
          <div class="progress-container">
            <div class="progress-bar" id="myBar"></div>
          </div>
        </section>

        <section class="scroll-target">
          <card-full />
        </section>

        <section>
          <testimonials
            bg="https://res.cloudinary.com/da32ufmnf/image/upload/v1646062637/atlas/kzcxf9aigsq42gfvwabr.png"
            class="scroll-target"
          />
        </section>

        <section>
          <signup
            class="scroll-target"
            headingOne="Work smarter."
            headingTwo="Get started today."
            subheading="Sign up today and make customer interaction easier, and smarter."
          />
        </section>
      </main>
      <foot class="width" />
    </div>
  </div>
</template>

<style lang="scss" scoped>
  @import "~static/style/grid.scss";

  .x {
    overflow-x: hidden;
  }

  .scroll-target {
    opacity: 0;
    transform: translateY(4rem);
    transition: all 600ms ease 100ms;
    will-change: transform, opacity;
  }

  .active {
    opacity: 1;
    transform: translateY(0);
  }

  .mesh {
    pointer-events: none;
  }

  .mesh-01 {
    position: absolute;
    top: 0;
    right: 0;
    @include breakpoint(md) {
      opacity: 0.88;
    }
  }

  .cards {
    margin-bottom: 14rem;
    @include breakpoint(md) {
      display: flex;
      justify-content: space-between;
      margin-bottom: 19.6rem;
    }
  }

  .card--sm {
    @include breakpoint(md) {
      width: grid-width(5);
    }
  }

  .card--md {
    @include breakpoint(md) {
      width: grid-width(6.5);
    }
  }

  .progress-container {
    position: relative;
    margin: 2rem auto 10rem;
    width: 100%;
    height: 5px;
    border-radius: 50px;
    background: rgba(255, 255, 255, 0.2);
    overflow: hidden;
    @include breakpoint(md) {
      margin-bottom: 20rem;
    }
  }

  .progress-bar {
    height: 5px;
    background: linear-gradient(106.92deg, #2942ee 0%, #a056ff 98.96%);
    border-radius: 50px;
    width: 0%;
  }

  .horizontal-scroll {
    display: flex;
    overflow-x: auto;
    -ms-overflow-style: none;
    scrollbar-width: none;
    cursor: grab;
    transition: transform 300ms ease;
    will-change: transform;
    * {
      margin-right: 2rem;
      flex: 0 0 grid-width(10);
      @include breakpoint(md) {
        margin-right: 4.8rem;
        flex: 0 0 grid-width(5);
      }
    }
  }

  .horizontal-scroll::-webkit-scrollbar {
    display: none;
  }
</style>

<script>
  export default {
    methods: {
      handleScroll() {
        const elements = document.querySelectorAll(".scroll-target")

        let observer = new IntersectionObserver((entries) => {
          entries.forEach((entry) => {
            if (entry.intersectionRatio > 0) {
              entry.target.classList.add("active")
            }
          })
        })

        elements.forEach((e) => {
          observer.observe(e)
        })
      },

      carousel() {
        const progressBar = document.querySelector(".progress-bar")
        const section = document.querySelector(".horizontal-scroll")
        let currentPixel = section.scrollLeft
        let isDown = false
        let startX
        let scrollLeft

        section.addEventListener("scroll", () => {
          const winScroll = section.scrollLeft || section.scrollLeft
          const width = section.scrollWidth - section.clientWidth
          const scrolled = (winScroll / width) * 100
          progressBar.style.width = scrolled + "%"

          this.scrollpos = section.scrollLeft
        })

        section.addEventListener("mousedown", (e) => {
          isDown = true
          section.classList.add("active")
          startX = e.pageX - section.offsetLeft
          scrollLeft = section.scrollLeft
        })

        section.addEventListener("mousedown", (e) => {
          section.style.cursor = "grabbing"
          section.style.transform = "scale(.98)"
          isDown = true
          startX = e.pageX - section.offsetLeft
          scrollLeft = section.scrollLeft
        })

        section.addEventListener("mouseup", () => {
          section.style.transform = "scale(1)"
          section.style.cursor = "grab"
          isDown = false
        })

        section.addEventListener("mousemove", (e) => {
          if (!isDown) return
          e.preventDefault()
          const x = e.pageX - section.offsetLeft
          const walk = (x - startX) * 0.8
          section.scrollLeft = scrollLeft - walk
        })
      },
    },
    mounted() {
      this.handleScroll()
      this.carousel()
    },
  }
</script>
